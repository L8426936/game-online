window.__require=function t(e,n,o){function i(r,s){if(!n[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var u="function"==typeof __require&&__require;if(!s&&u)return u(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var h=n[r]={exports:{}};e[r][0].call(h.exports,function(t){return i(e[r][1][t]||t)},h,h.exports,t,e,n,o)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)i(o[r]);return i}({DynamicAdapt:[function(t,e,n){"use strict";cc._RF.push(e,"f2077bGMhtO1p8o07ptdrED","DynamicAdapt");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator.ccclass,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){var t=this;cc.view.setResizeCallback(function(){return t._adapt()}),this._adapt()},e.prototype.start=function(){},e.prototype._adapt=function(){var t=cc.winSize.width/cc.winSize.height,e=cc.Canvas.instance.designResolution.width/cc.Canvas.instance.designResolution.height;t<=1&&t<=e?this._fitWidth():this._fitHeight()},e.prototype._fitWidth=function(){cc.Canvas.instance.fitHeight=!1,cc.Canvas.instance.fitWidth=!0},e.prototype._fitHeight=function(){cc.Canvas.instance.fitHeight=!0,cc.Canvas.instance.fitWidth=!1},a([r],e)}(cc.Component);n.default=s,cc._RF.pop()},{}],Hexagon:[function(t,e,n){"use strict";cc._RF.push(e,"c3b3fuU+nZNzLH4haHZcKVm","Hexagon");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator.ccclass,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getOriginIndex=function(){return this._originIndex},e.prototype.setOriginIndex=function(t){this._originIndex=t},e.prototype.getCubeX=function(){return this._cubeX},e.prototype.setCubeX=function(t){this._cubeX=t},e.prototype.getCubeY=function(){return this._cubeY},e.prototype.setCubeY=function(t){this._cubeY=t},e.prototype.getCubeZ=function(){return this._cubeZ},e.prototype.setCubeZ=function(t){this._cubeZ=t},e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(t){this._value=t},a([r],e)}(cc.Node);n.default=s,cc._RF.pop()},{}],Main:[function(t,e,n){"use strict";cc._RF.push(e,"04c203m6m5O5JXrCDFDde6R","Main");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./StatusUtil"),s=cc._decorator.ccclass,c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){var t=this;cc.game.on("swapAction",function(e){return t._action=e}),cc.find("Canvas/TopContainer/LeftContainer/NewGameButton").on(cc.Node.EventType.TOUCH_END,function(){return t._newGame()}),cc.find("Canvas/TopContainer/RightContainer/ReGameButton").on(cc.Node.EventType.TOUCH_END,function(){return t._reGame()}),cc.find("Canvas/TopContainer/RightContainer/PreviousStatusButton").on(cc.Node.EventType.TOUCH_END,function(){return t._previousAction()}),cc.find("Canvas/DisableMask").on(cc.Node.EventType.TOUCH_END,function(){})},e.prototype.start=function(){var t=this;setTimeout(function(){return t._newGame()},100)},e.prototype._newGame=function(){var t=this;cc.find("Canvas/DisableMask").active=!0,cc.find("Canvas/StartStatusContainer").children.forEach(function(t){return cc.tween(t).to(.3,{scale:0}).start()}),cc.find("Canvas/TopContainer/EndStatusContainer").children.forEach(function(t){return cc.tween(t).to(.3,{scale:0}).start()}),setTimeout(function(){cc.find("Canvas/StartStatusContainer").removeAllChildren(),cc.find("Canvas/TopContainer/EndStatusContainer").removeAllChildren(),t._layer=Math.floor(2*Math.random()+2);var e,n,o=Math.ceil(.1*3*Math.random()*t._layer*(t._layer+1)+1)+2;cc.log("layer: ",t._layer),cc.log("count: ",o);for(var i=!0;i;){e=r.default.randomStatus(t._layer,o),n=r.default.randomStatus(t._layer,o);for(var a=3*t._layer*(t._layer+1);a>=0;a--)if(e[a]!=n[a]){i=!1;break}}t._previousActions=new Array,cc.find("Canvas/TopContainer/LeftContainer/StepLabelNode").getComponentInChildren(cc.Label).string="\u6b65\u6570:"+t._previousActions.length,t._statusUtil=new r.default(t._layer);var s=cc.find("Canvas/StartStatusContainer");t._startHexagons=t._statusUtil.drawStatus(e,.8*Math.min(s.height,s.width)/(2*(4*t._layer+1)));var c=cc.find("Canvas/TopContainer/EndStatusContainer");t._endHexagons=t._statusUtil.drawStatus(n,.8*Math.min(c.height,c.width)/(2*(4*t._layer+1))),t._startHexagons.forEach(function(e){e.scale=0,e.parent=s,cc.tween(e).to(.3,{scale:1}).call(function(){return e.on(cc.Node.EventType.TOUCH_END,function(){return t._actionStatus(e,t._action,!1)})}).start()}),t._endHexagons.forEach(function(t){t.scale=0,t.parent=c,cc.tween(t).to(.3,{scale:1}).start()}),setTimeout(function(){cc.find("Canvas/DisableMask").active=!1,t._statusUtil.printlnStatus(t._startHexagons)},400)},400)},e.prototype._reGame=function(){var t=this;cc.find("Canvas/DisableMask").active=!0,this._previousActions=new Array,cc.find("Canvas/TopContainer/LeftContainer/StepLabelNode").getComponentInChildren(cc.Label).string="\u6b65\u6570:"+this._previousActions.length;for(var e=0;e<this._startHexagons.length;e++){var n=this._startHexagons[e];cc.tween(n).to(.3,{x:this._startHexagons[n.getOriginIndex()].x,y:this._startHexagons[n.getOriginIndex()].y}).start()}setTimeout(function(){for(var e=0;e<t._startHexagons.length;e++){var n=t._startHexagons[e];if(n.getOriginIndex()!=e)for(var o=e+1;o<t._startHexagons.length;o++){var i=t._startHexagons[o];if(i.getOriginIndex()==e){t._startHexagons[e]=i,t._startHexagons[o]=n,n.setCubeX(t._statusUtil.indexToX(n.getOriginIndex())),n.setCubeY(t._statusUtil.indexToY(n.getOriginIndex())),n.setCubeZ(t._statusUtil.indexToZ(n.getOriginIndex())),i.setCubeX(t._statusUtil.indexToX(i.getOriginIndex())),i.setCubeY(t._statusUtil.indexToY(i.getOriginIndex())),i.setCubeZ(t._statusUtil.indexToZ(i.getOriginIndex()));break}}}cc.find("Canvas/DisableMask").active=!1},400)},e.prototype._actionStatus=function(t,e,n){var o=this;cc.find("Canvas/DisableMask").active=!0;var i=t.getCubeX(),a=t.getCubeY(),r=t.getCubeZ();if(Math.abs(i)>=Math.abs(this._layer)||Math.abs(a)>=Math.abs(this._layer)||Math.abs(r)>=Math.abs(this._layer)){var s=cc.tween(t).by(.01,{x:-15}).by(.02,{x:30}).by(.01,{x:-15});s.repeat(10,s).call(function(){return cc.find("Canvas/DisableMask").active=!1}).start()}else{var c=this._statusUtil.newStatus(this._startHexagons,i,a,r,e);if(!n)switch(e){case 1:this._previousActions.push({action:3,index:this._statusUtil.xyzToIndex(i,a,r)});break;case 2:this._previousActions.push({action:2,index:this._statusUtil.xyzToIndex(i,a,r)});break;case 3:this._previousActions.push({action:1,index:this._statusUtil.xyzToIndex(i,a,r)})}cc.find("Canvas/TopContainer/LeftContainer/StepLabelNode").getComponentInChildren(cc.Label).string="\u6b65\u6570:"+this._previousActions.length;for(var u=function(t){cc.tween(c[t]).to(.2,{x:h._startHexagons[t].x,y:h._startHexagons[t].y}).call(function(){c[t].setCubeX(o._statusUtil.indexToX(t)),c[t].setCubeY(o._statusUtil.indexToY(t)),c[t].setCubeZ(o._statusUtil.indexToZ(t))}).start()},h=this,f=0;f<c.length;f++)u(f);setTimeout(function(){o._startHexagons=c,cc.find("Canvas/DisableMask").active=!1,o._checkPass()&&(cc.find("Canvas/PassRound").active=!0,cc.find("Canvas/PassRound/DisableMask").on(cc.Node.EventType.TOUCH_END,function(){}),cc.find("Canvas/PassRound").getComponentInChildren(cc.Label).string="\u901a\u5173\u6b65\u6570:"+o._previousActions.length,cc.find("Canvas/PassRound/ReGameButton").on(cc.Node.EventType.TOUCH_END,function(){cc.find("Canvas/PassRound").active=!1,o._reGame()}),cc.find("Canvas/PassRound/NewGameButton").on(cc.Node.EventType.TOUCH_END,function(){cc.find("Canvas/PassRound").active=!1,o._newGame()})),o._statusUtil.printlnStatus(o._startHexagons)},300)}},e.prototype._previousAction=function(){if(this._previousActions.length>0){var t=this._previousActions.pop();this._actionStatus(this._startHexagons[t.index],t.action,!0)}},e.prototype._checkPass=function(){for(var t=0;t<this._startHexagons.length;t++)if(this._startHexagons[t].getValue()!=this._endHexagons[t].getValue())return!1;return!0},a([s],e)}(cc.Component);n.default=c,cc._RF.pop()},{"./StatusUtil":"StatusUtil"}],StatusUtil:[function(t,e,n){"use strict";cc._RF.push(e,"b4f55VYE69B7a0NZiIbTlb1","StatusUtil"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("./Hexagon"),i=function(){function t(t){var e=3*t*(t+1)+1;this._layer=t,this._indexToX=new Array(e),this._indexToY=new Array(e),this._indexToZ=new Array(e);for(var n=0,o=-t;o<=t;o++)for(var i=-t;i<=t;i++)for(var a=-t;a<=t;a++)i+a+o==0&&(this._indexToX[n]=i,this._indexToY[n]=a,this._indexToZ[n++]=o);var r=2*t+1;this._xyzToIndex=new Array(r*r),n=0;for(var s=-t;s<=t;s++)for(var c=0;c<r;c++)this._xyzToIndex[r*(s+t)+c]=c<r-Math.abs(s)?n++:-1}return t.prototype.xyzToIndex=function(t,e,n){return this._xyzToIndex[(1+(this._layer<<1))*(this._layer+n)+(n<=0?this._layer-e:this._layer+t)]},t.prototype.indexToX=function(t){return this._indexToX[t]},t.prototype.indexToY=function(t){return this._indexToY[t]},t.prototype.indexToZ=function(t){return this._indexToZ[t]},t.randomStatus=function(t,e){var n=3*t*(t+1)+1;if(!(e>n)){for(var o=new Array(n),i=n-1;i>=0;i--)o[i]=e>i;for(var a=n-1;a>0;a--){var r=Math.floor(Math.random()*(a+1)),s=o[r];o[r]=o[a],o[a]=s}return o}},t.prototype.printlnStatus=function(t){for(var e="",n=0,o=-this._layer;o<=this._layer;o++){for(var i=Math.abs(o);i>0;i--)e+=" ";for(i=2*this._layer+1-Math.abs(o);i>0;i--)t[n++].getValue()?e+="\u25cf":e+="\u25cb",i>1&&(e+=" ");e+="\n"}cc.log(e)},t.prototype.drawStatus=function(t,e){for(var n=new Array(t.length),i=0;i<t.length;i++){var a=this.indexToX(i),r=this.indexToY(i),s=this.indexToZ(i),c=2*(s<=0?this._layer-r:this._layer+a)-(2*this._layer-Math.abs(s)),u=new o.default;u.width=2*e,u.height=2*Math.cos(Math.PI/6)*e,u.x=2*e*c,u.y=4*e*Math.sin(Math.PI/3)*-s,u.setOriginIndex(i),u.setCubeX(a),u.setCubeY(r),u.setCubeZ(s),u.setValue(t[i]);var h=u.addComponent(cc.Graphics);h.moveTo(e*Math.cos(0),e*Math.sin(0));for(var f=0;f<=6;f++){var d=60*f,l=Math.PI/180*d;h.lineTo(e*Math.cos(l),e*Math.sin(l))}t[i]?(h.fillColor.set(cc.Color.BLACK),h.fill()):(h.strokeColor.set(cc.Color.BLACK),h.stroke()),h.close(),n[i]=u}return n},t.prototype.newStatus=function(t,e,n,o,i){var a=new Array;switch(Object.assign(a,t),i){case 1:a[this.xyzToIndex(e,n+1,o-1)]=t[this.xyzToIndex(e-1,n+1,o)],a[this.xyzToIndex(e+1,n,o-1)]=t[this.xyzToIndex(e,n+1,o-1)],a[this.xyzToIndex(e-1,n+1,o)]=t[this.xyzToIndex(e-1,n,o+1)],a[this.xyzToIndex(e+1,n-1,o)]=t[this.xyzToIndex(e+1,n,o-1)],a[this.xyzToIndex(e-1,n,o+1)]=t[this.xyzToIndex(e,n-1,o+1)],a[this.xyzToIndex(e,n-1,o+1)]=t[this.xyzToIndex(e+1,n-1,o)];break;case 2:a[this.xyzToIndex(e,n+1,o-1)]=t[this.xyzToIndex(e,n-1,o+1)],a[this.xyzToIndex(e+1,n,o-1)]=t[this.xyzToIndex(e-1,n,o+1)],a[this.xyzToIndex(e-1,n+1,o)]=t[this.xyzToIndex(e+1,n-1,o)],a[this.xyzToIndex(e+1,n-1,o)]=t[this.xyzToIndex(e-1,n+1,o)],a[this.xyzToIndex(e-1,n,o+1)]=t[this.xyzToIndex(e+1,n,o-1)],a[this.xyzToIndex(e,n-1,o+1)]=t[this.xyzToIndex(e,n+1,o-1)];break;case 3:a[this.xyzToIndex(e,n+1,o-1)]=t[this.xyzToIndex(e+1,n,o-1)],a[this.xyzToIndex(e+1,n,o-1)]=t[this.xyzToIndex(e+1,n-1,o)],a[this.xyzToIndex(e-1,n+1,o)]=t[this.xyzToIndex(e,n+1,o-1)],a[this.xyzToIndex(e+1,n-1,o)]=t[this.xyzToIndex(e,n-1,o+1)],a[this.xyzToIndex(e-1,n,o+1)]=t[this.xyzToIndex(e-1,n+1,o)],a[this.xyzToIndex(e,n-1,o+1)]=t[this.xyzToIndex(e-1,n,o+1)]}return a},t}();n.default=i,cc._RF.pop()},{"./Hexagon":"Hexagon"}],SwapButton:[function(t,e,n){"use strict";cc._RF.push(e,"2bd17Nsu01N8IJ69cObSSht","SwapButton");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./StatusUtil"),s=cc._decorator,c=s.ccclass,u=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.action=0,e}return i(e,t),e.prototype.start=function(){var t=this;setTimeout(function(){var e=Math.floor(4*Math.random())+2;t._statusUtil=new r.default(1),t._hexagons=t._statusUtil.drawStatus(r.default.randomStatus(1,e),.8*Math.min(t.node.width,t.node.height)/10)},10),setTimeout(function(){t._hexagons.forEach(function(e){e.scale=0,e.parent=t.node,cc.tween(e).to(.3,{scale:1}).call(function(){t._buildTouchEnd()}).start()}),t._touchEnd()},100)},e.prototype._touchEnd=function(){this.node.off(cc.Node.EventType.TOUCH_END),cc.game.emit("swapAction",this.action),cc.find("Canvas/ActionRange").children.forEach(function(t){return t.removeComponent(cc.Graphics)});var t=this.node.addComponent(cc.Graphics),e=.5*Math.min(this.node.width,this.node.height);t.moveTo(e,0);for(var n=0;n<=6;n++){var o=60*n,i=Math.PI/180*o;t.lineTo(e*Math.cos(i),e*Math.sin(i))}t.strokeColor.set(cc.Color.BLACK),t.stroke(),t.close()},e.prototype._buildTouchEnd=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t._touchEnd(),t._animation()})},e.prototype._animation=function(){for(var t=this,e=this._statusUtil.newStatus(this._hexagons,0,0,0,this.action),n=function(n){cc.tween(e[n]).to(.5,{x:o._hexagons[n].x,y:o._hexagons[n].y}).call(function(){e[n].setCubeX(t._statusUtil.indexToX(n)),e[n].setCubeY(t._statusUtil.indexToY(n)),e[n].setCubeZ(t._statusUtil.indexToZ(n))}).start()},o=this,i=0;i<e.length;i++)n(i);setTimeout(function(){t._hexagons=e,t._buildTouchEnd(),t._statusUtil.printlnStatus(t._hexagons)},600)},a([u],e.prototype,"action",void 0),a([c],e)}(cc.Component);n.default=h,cc._RF.pop()},{"./StatusUtil":"StatusUtil"}]},{},["DynamicAdapt","Hexagon","Main","StatusUtil","SwapButton"]);